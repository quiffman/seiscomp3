SET(
	TTTDATA_GENERATED
		${CMAKE_CURRENT_BINARY_DIR}/iasp91.tbl
		${CMAKE_CURRENT_BINARY_DIR}/iasp91.hed
)

SET(
	TTTDATA_DATA
		${TTTDATA_GENERATED}
		iasp91.tvel
		ak135.tvel
)

SET(EXECUTABLE_OUTPUT_PATH ${CMAKE_CURRENT_BINARY_DIR})
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/..)
LINK_LIBRARIES(tau_internal -lm)
ADD_EXECUTABLE(remodl ../bin/remodl.c)
ADD_EXECUTABLE(setbrn ../bin/setbrn.c)

ADD_CUSTOM_TARGET(TTTData ALL DEPENDS remodl setbrn)

IF (WIN32)
MESSAGE(STATUS "Calling remodl and setbrn from ${CMAKE_CURRENT_SOURCE_DIR}")
ADD_CUSTOM_COMMAND(
	COMMAND ${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_CFG_INTDIR}/remodl
	DEPENDS remodl
	OUTPUTS remodl.tbl remodl.hed
	TARGET  TTTData
)

ADD_CUSTOM_COMMAND(
	COMMAND ${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_CFG_INTDIR}/setbrn
	DEPENDS setbrn remodl.tbl remodl.hed
	OUTPUTS iasp91.tbl iasp91.hed
	TARGET  TTTData
)
ELSE (WIN32)
IF("${CMAKE_MAJOR_VERSION}.${CMAKE_MINOR_VERSION}" STRLESS "2.6")
        SET(TAU_COMMAND_PREFIX "${CMAKE_CURRENT_BINARY_DIR}/")
ELSE("${CMAKE_MAJOR_VERSION}.${CMAKE_MINOR_VERSION}" STRLESS "2.6")
        SET(TAU_COMMAND_PREFIX "")
ENDIF("${CMAKE_MAJOR_VERSION}.${CMAKE_MINOR_VERSION}" STRLESS "2.6")
ADD_CUSTOM_COMMAND(
        COMMAND ${TAU_COMMAND_PREFIX}remodl
        DEPENDS remodl
        OUTPUTS remodl.tbl remodl.hed
        TARGET  TTTData
)

ADD_CUSTOM_COMMAND(
        COMMAND ${TAU_COMMAND_PREFIX}setbrn
        DEPENDS setbrn remodl.tbl remodl.hed
        OUTPUTS iasp91.tbl iasp91.hed
        TARGET  TTTData
)
ENDIF (WIN32)

SET_SOURCE_FILES_PROPERTIES(
	${TTTDATA_GENERATED}
	PROPERTIES GENERATED 1
)


SET(
	CLEAN_FILES
		${TTTDATA_GENERATED}
		remodl.hed
		remodl.tbl
		remodl1.lis
		remodl2.lis
		setbrn1.lis
		setbrn2.lis
		setbrn3.lis
)

SET_DIRECTORY_PROPERTIES(PROPERTIES ADDITIONAL_MAKE_CLEAN_FILES "${CLEAN_FILES}")

SC_INSTALL_DATA(TTTDATA ttt)
